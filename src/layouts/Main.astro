---
const { head, description, image } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>THE.GALLERY</title>
  </head>
    <!-- Bootstrap JS (kept) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Active-nav + optional widgets -->
    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        /** ---------------------------
         * Utility: normalize base path
         * --------------------------- */
        const basePath = "/the.gallery"; // GitHub Pages subfolder
        const stripBase = (href) => {
          if (!href) return "/";
          let out = href;
          if (out.startsWith(basePath)) out = out.slice(basePath.length);
          out = out.replace(/\/+$/, ""); // trim trailing slash
          return out === "" ? "/" : out;
        };
        /** ---------------------------
         * OPTIONAL: Filter nav (guarded)
         * --------------------------- */
        const filterNav = document.getElementById("filterNav");
        const cards = document.querySelectorAll(".gallery-card");
        if (filterNav && cards.length) {
          filterNav.addEventListener("click", (e) => {
            if (e.target.tagName !== "A") return;
            e.preventDefault();

            filterNav.querySelectorAll("a").forEach((link) => link.classList.remove("active"));
            e.target.classList.add("active");

            const filter = e.target.getAttribute("data-filter");
            cards.forEach((card) => {
              const cat = card.dataset.category;
              if (filter === "all" || cat === filter) {
                card.classList.remove("hide");
              } else {
                card.classList.add("hide");
              }
            });
          });
        }

        /** ---------------------------
         * OPTIONAL: Section indicator (guarded)
         * --------------------------- */
        const indicator = document.querySelector(".indicator");
        const navline = document.querySelector(".navline");
        if (indicator && navline) {
          const navLinks = navline.querySelectorAll("a");
          const moveIndicator = (el) => {
            const linkRect = el.getBoundingClientRect();
            const parentRect = navline.getBoundingClientRect();
            indicator.style.width = `${linkRect.width}px`;
            indicator.style.left = `${linkRect.left - parentRect.left}px`;
          };
          const activeLink = navline.querySelector("a.active");
          if (activeLink) moveIndicator(activeLink);

          navLinks.forEach((l) =>
            l.addEventListener("click", (e) => {
              // allow navigation in production; prevent only if testing animations
              // e.preventDefault();
              navLinks.forEach((x) => x.classList.remove("active"));
              e.currentTarget.classList.add("active");
              moveIndicator(e.currentTarget);
            })
          );
          window.addEventListener("resize", () => {
            const currentActive = navline.querySelector("a.active");
            if (currentActive) moveIndicator(currentActive);
          });
        }
      });
      // Prevent the dropdown toggle from scrolling to top when clicked
document.addEventListener("DOMContentLoaded", () => {
  const basePath = "/the.gallery";
  const stripBase = (href) => {
    if (!href) return "/";
    let out = href;
    if (out.startsWith(basePath)) out = out.slice(basePath.length);
    out = out.replace(/\/+$/, "");
    return out === "" ? "/" : out;
  };
  const current = stripBase(window.location.pathname);

  // Reset nav
  document.querySelectorAll(".navbar-nav .nav-link, .dropdown-item").forEach(el => {
    el.classList.remove("active");
    el.removeAttribute("aria-current");
  });

  // Highlight child dropdown first
  let matchedChild = false;
  document.querySelectorAll(".dropdown-menu .dropdown-item").forEach(item => {
    const href = stripBase(item.getAttribute("href"));
    if (href && href === current) {
      matchedChild = true;
      item.classList.add("active");
      item.setAttribute("aria-current", "page");
    }
  });

  // If child matched, highlight dropdown toggle
  if (matchedChild) {
    const toggle = document.querySelector(".nav-item.dropdown > .nav-link.dropdown-toggle");
    if (toggle) toggle.classList.add("active");
  } else {
    // Highlight top-level
    document.querySelectorAll('.navbar-nav > .nav-item > .nav-link:not(.dropdown-toggle)').forEach(link => {
      const href = stripBase(link.getAttribute("href"));
      if (href === current) {
        link.classList.add("active");
        link.setAttribute("aria-current", "page");
      }
    });

    // Special case: /gallery itself
    if (current.startsWith("/gallery")) {
      const toggle = document.querySelector(".nav-item.dropdown > .nav-link.dropdown-toggle");
      if (toggle) toggle.classList.add("active");
    }
  }
});
    </script>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="/the.gallery">THE.GALLERY</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <!-- NOTE: no hard-coded 'active' anywhere below -->
            <li class="nav-item">
              <a class="nav-link" href="/the.gallery">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/the.gallery/about">About</a>
            </li>
          <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Gallery
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/the.gallery/gallery/poster">Poster</a></li>
                <li><a class="dropdown-item" href="/the.gallery/gallery/terrarium">Terrarium</a></li>
                <li><a class="dropdown-item" href="/the.gallery/gallery/photography">Photography</a></li>
                <li><a class="dropdown-item" href="/the.gallery/gallery/blender">Blender</a></li>
                <li><a class="dropdown-item" href="/the.gallery/gallery/book">Book</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Hero -->
    <header 
        class="bg-dark text-white text-center py-5"
        style={image
        ? `background: url(${image}) center/cover no-repeat;`
        : "background-color: #212529;"}
        >
      <div class="container">
        <h1 class="display-4">{head}</h1>
        <p class="lead">{description}</p>
      </div>
    </header>

    <!-- Page slot -->
    <section class="py-5 container">
      <slot />
    </section>

    <!-- Footer -->
        <footer class="bg-dark text-white py-4 mt-5 footer-padding">
      <div class="container">
        <div class="row">
          <div class="col-md mb footer-text justify-content-center justify-content-md-start">
            <h5>THE.GALLERY</h5>
            <p >
              This is the gallery of one person who just want to share something for fun, some might look beautiful, some might not. 
              But all are made with passion and love. I have many kind of thing in this website and looking forward for more, You can kindly 
              support me by sharing this website to your friends. Thank you for visiting.
            </p>
          </div>
          <div class="col-md mb footer-text just">
            <h5>Contact Us</h5>
            <ul class="list-unstyled">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-instagram" viewBox="0 0 16 16">
                <path href="www.facebook.com" d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.9 3.9 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233s.008-2.388.046-3.231c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92m-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217m0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"/>
              </svg>
              <li><a href="#" class="text-white">Event</a></li>
              <li><a href="#" class="text-white">Gallery</a></li>
              <li><a href="#" class="text-white">Pages</a></li>
              <li><a href="#" class="text-white">Blog</a></li>
              <li><a href="#" class="text-white">Contact</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>

<style>
  html, body { margin: 0; width: 100%; height: 100%; }

  /* Cards */
  .gallery-card { transition: transform 0.4s ease, opacity 0.4s ease; }
  .hide { opacity: 0; transform: translateX(-50px); pointer-events: none; position: absolute; }

  /* Active colors */
  .navbar-nav .nav-link.active,
  .navbar-nav .dropdown-toggle.active {
    color: #fff !important;
  }

  .footer-text {
    color: #ccc;
    font-size: 14px;
  }

  .footer-padding {
    padding: 0px 20px;
  }
</style>
