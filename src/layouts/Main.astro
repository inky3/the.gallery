---
const { head, description } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>THE.GALLERY</title>
  </head>
    <!-- Bootstrap JS (kept) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Active-nav + optional widgets -->
    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        /** ---------------------------
         * Utility: normalize base path
         * --------------------------- */
        const basePath = "/the.gallery"; // GitHub Pages subfolder
        const stripBase = (href) => {
          if (!href) return "/";
          let out = href;
          if (out.startsWith(basePath)) out = out.slice(basePath.length);
          out = out.replace(/\/+$/, ""); // trim trailing slash
          return out === "" ? "/" : out;
        };
        /** ---------------------------
         * OPTIONAL: Filter nav (guarded)
         * --------------------------- */
        const filterNav = document.getElementById("filterNav");
        const cards = document.querySelectorAll(".gallery-card");
        if (filterNav && cards.length) {
          filterNav.addEventListener("click", (e) => {
            if (e.target.tagName !== "A") return;
            e.preventDefault();

            filterNav.querySelectorAll("a").forEach((link) => link.classList.remove("active"));
            e.target.classList.add("active");

            const filter = e.target.getAttribute("data-filter");
            cards.forEach((card) => {
              const cat = card.dataset.category;
              if (filter === "all" || cat === filter) {
                card.classList.remove("hide");
              } else {
                card.classList.add("hide");
              }
            });
          });
        }

        /** ---------------------------
         * OPTIONAL: Section indicator (guarded)
         * --------------------------- */
        const indicator = document.querySelector(".indicator");
        const navline = document.querySelector(".navline");
        if (indicator && navline) {
          const navLinks = navline.querySelectorAll("a");
          const moveIndicator = (el) => {
            const linkRect = el.getBoundingClientRect();
            const parentRect = navline.getBoundingClientRect();
            indicator.style.width = `${linkRect.width}px`;
            indicator.style.left = `${linkRect.left - parentRect.left}px`;
          };
          const activeLink = navline.querySelector("a.active");
          if (activeLink) moveIndicator(activeLink);

          navLinks.forEach((l) =>
            l.addEventListener("click", (e) => {
              // allow navigation in production; prevent only if testing animations
              // e.preventDefault();
              navLinks.forEach((x) => x.classList.remove("active"));
              e.currentTarget.classList.add("active");
              moveIndicator(e.currentTarget);
            })
          );
          window.addEventListener("resize", () => {
            const currentActive = navline.querySelector("a.active");
            if (currentActive) moveIndicator(currentActive);
          });
        }
      });
      // Prevent the dropdown toggle from scrolling to top when clicked
document.addEventListener("DOMContentLoaded", () => {
  const basePath = "/the.gallery";
  const stripBase = (href) => {
    if (!href) return "/";
    let out = href;
    if (out.startsWith(basePath)) out = out.slice(basePath.length);
    out = out.replace(/\/+$/, "");
    return out === "" ? "/" : out;
  };
  const current = stripBase(window.location.pathname);

  // Reset nav
  document.querySelectorAll(".navbar-nav .nav-link, .dropdown-item").forEach(el => {
    el.classList.remove("active");
    el.removeAttribute("aria-current");
  });

  // Highlight child dropdown first
  let matchedChild = false;
  document.querySelectorAll(".dropdown-menu .dropdown-item").forEach(item => {
    const href = stripBase(item.getAttribute("href"));
    if (href && href === current) {
      matchedChild = true;
      item.classList.add("active");
      item.setAttribute("aria-current", "page");
    }
  });

  // If child matched, highlight dropdown toggle
  if (matchedChild) {
    const toggle = document.querySelector(".nav-item.dropdown > .nav-link.dropdown-toggle");
    if (toggle) toggle.classList.add("active");
  } else {
    // Highlight top-level
    document.querySelectorAll('.navbar-nav > .nav-item > .nav-link:not(.dropdown-toggle)').forEach(link => {
      const href = stripBase(link.getAttribute("href"));
      if (href === current) {
        link.classList.add("active");
        link.setAttribute("aria-current", "page");
      }
    });

    // Special case: /gallery itself
    if (current.startsWith("/gallery")) {
      const toggle = document.querySelector(".nav-item.dropdown > .nav-link.dropdown-toggle");
      if (toggle) toggle.classList.add("active");
    }
  }
});
    </script>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="/the.gallery">THE.GALLERY</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <!-- NOTE: no hard-coded 'active' anywhere below -->
            <li class="nav-item">
              <a class="nav-link" href="/the.gallery">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/the.gallery/about">About</a>
            </li>
          <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Gallery
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/the.gallery/gallery/poster">Poster</a></li>
                <li><a class="dropdown-item" href="/the.gallery/gallery/terrarium">Terrarium</a></li>
                <li><a class="dropdown-item" href="/the.gallery/gallery/photography">Photography</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Hero -->
    <header class="bg-dark text-white text-center py-5">
      <div class="container">
        <h1 class="display-4">{head}</h1>
        <p class="lead">{description}</p>
      </div>
    </header>

    <!-- Page slot -->
    <section class="py-5 container">
      <slot />
    </section>

    <!-- Footer -->
        <footer class="bg-dark text-white py-4 mt-5 footer-padding">
      <div class="container">
        <div class="row">
          <div class="col-md mb footer-text justify-content-center justify-content-md-start">
            <h5>THE.GALLERY</h5>
            <p >
              This is the gallery of one person who just want to share something for fun, some might look beautiful, some might not. 
              But all are made with passion and love. I have many kind of thing in this website and looking forward for more, You can kindly 
              support me by sharing this website to your friends. Thank you for visiting.
            </p>
          </div>
          <div class="col-md mb footer-text">
            <h5>Contact Us</h5>
            <ul class="list-unstyled">
              <li><a href="#" class="text-white">About</a></li>
              <li><a href="#" class="text-white">Event</a></li>
              <li><a href="#" class="text-white">Gallery</a></li>
              <li><a href="#" class="text-white">Pages</a></li>
              <li><a href="#" class="text-white">Blog</a></li>
              <li><a href="#" class="text-white">Contact</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>

<style>
  html, body { margin: 0; width: 100%; height: 100%; }

  /* Cards */
  .gallery-card { transition: transform 0.4s ease, opacity 0.4s ease; }
  .hide { opacity: 0; transform: translateX(-50px); pointer-events: none; position: absolute; }

  /* Active colors */
  .navbar-nav .nav-link.active,
  .navbar-nav .dropdown-toggle.active {
    color: #fff !important;
  }

  .footer-text {
    color: #ccc;
    font-size: 14px;
  }

  .footer-padding {
    padding: 0px 20px;
  }
</style>
