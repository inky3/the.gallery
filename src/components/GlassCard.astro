---
/**
 * GlassCard — FULL overlay version
 * Idle: image + centered pill near bottom
 * Hover/Tap: glass overlay fills card; shows meta/title/intro + tag pills
 *
 * Props:
 *  - href: string
 *  - title: string
 *  - meta?: string
 *  - image: string
 *  - intro?: string
 *  - tags?: string[]  // ["uxui","coding"]
 *  - ratio?: string   // default "16/9"
 */
const {
  href = "#",
  title = "",
  meta = "",
  image = "",
  intro = "",
  tags = [],
  ratio = "16/9",
} = Astro.props;

const base = import.meta.env.BASE_URL || "/";
const resolve = (p="") => /^https?:\/\//i.test(p) ? p : `${base}${p.replace(/^\/+/, "")}`;

const primary = tags[0] || "Project";
const label = (t: string) => t === "uxui" ? "UX/UI Design" : (t === "coding" ? "Coding" : t);
---
<a class="gcard gcard--overlay" href={resolve(href)} aria-label={`Open ${title}`} data-tags={(tags || []).join(",")}>
  <figure class="gcard__media" style={`aspect-ratio:${ratio}`}>
    <img src={resolve(image)} alt="" loading="lazy" decoding="async" />
    <div class="gcard__vignette"></div>

    <!-- Idle pill (visible at rest) -->
    <div class="gcard__idlepill">{label(primary)}</div>

    <!-- FULL overlay: hidden by default, fills the card -->
    <figcaption class="gcard__overlay">
      <div class="gcard__copy">
        {meta && <p class="gcard__k">{meta}</p>}
        <h3 class="gcard__t">{title}</h3>
        {intro && <p class="gcard__intro">{intro}</p>}

        {tags?.length > 0 && (
          <div class="gcard__tags">
            {tags.map(t => <span class="tag">{label(t)}</span>)}
          </div>
        )}
      </div>
    </figcaption>
  </figure>
</a>

<style>
.gcard{
  display:block; position:relative; text-decoration:none; color:inherit;
  border-radius:22px; overflow:hidden; background:var(--bg-elev,#fff);
  border:1px solid var(--border-subtle,rgba(0,0,0,.06));
  box-shadow: 0 10px 24px rgba(0,0,0,.10), 0 2px 6px rgba(0,0,0,.06);
  transition: transform .25s ease, box-shadow .25s ease, border-color .2s ease;
}
.gcard:hover{ transform:translateY(-4px); box-shadow:0 18px 36px rgba(0,0,0,.16), 0 6px 14px rgba(0,0,0,.10); }

.gcard__media{ position:relative; margin:0; }
.gcard__media img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; display:block; }

/* soften base vignette */
.gcard__vignette{
  position:absolute; inset:0; pointer-events:none;
  background: radial-gradient(60% 60% at 50% 45%, rgba(0,0,0,.00) 0%, rgba(0,0,0,.20) 100%);
  opacity:.55;
}

/* Idle pill */
.gcard__idlepill{
  position:absolute; left:50%; transform:translateX(-50%);
  bottom:14px; z-index:3;
  padding:8px 14px; border-radius:999px; font-weight:700; font-size:.95rem;
  background:rgba(0,0,0,.78); color:#fff;
  box-shadow:0 2px 8px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.22);
  pointer-events:none;
  transition:opacity .18s ease;
}

/* FULL glass overlay */
.gcard__overlay{
  position:absolute; inset:0; display:grid; align-items:end;
  padding:16px;
  z-index:4;                         /* ↑ ensure above everything */
  pointer-events:none;               /* clicks still pass to the <a> */
  background:
    linear-gradient(180deg, rgba(0,0,0,.05) 0%, rgba(0,0,0,.40) 60%, rgba(0,0,0,.65) 100%),
    rgba(255,255,255,.12);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-top:1px solid rgba(255,255,255,.30);
  border-left:1px solid rgba(255,255,255,.22);

  opacity:0; transform:translateY(14px);
  transition: opacity .32s cubic-bezier(.2,.7,.2,1), transform .32s cubic-bezier(.2,.7,.2,1);
}
.gcard:hover .gcard__overlay,
.gcard:focus-within .gcard__overlay,
.gcard.is-open .gcard__overlay{ opacity:1; transform:none; }
.gcard:hover .gcard__idlepill,
.gcard:focus-within .gcard__idlepill,
.gcard.is-open .gcard__idlepill{ opacity:0; }

.gcard__copy{ color:#fff; max-width:78%; text-shadow:0 1px 2px rgba(0,0,0,.35); }
.gcard__k{ margin:0 0 .2rem; font-size:.9rem; opacity:.9; }
.gcard__t{ margin:.05rem 0 .35rem; font-size:1.25rem; font-weight:800; letter-spacing:.1px; }
.gcard__intro{
  margin:0 0 .7rem; font-size:.95rem; line-height:1.45; color:rgba(255,255,255,.92);
  display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden;
}
.gcard__tags{ display:flex; gap:.4rem; flex-wrap:wrap; }
.tag{
  padding:.35rem .6rem; border-radius:999px; font-size:.85rem; font-weight:600;
  background:rgba(255,255,255,.20); border:1px solid rgba(255,255,255,.34); color:#fff;
}

@media (prefers-color-scheme: light){
  .gcard__overlay{
    background:
      linear-gradient(180deg, rgba(255,255,255,.00) 0%, rgba(255,255,255,.60) 100%),
      rgba(255,255,255,.48);
    color:#101418;
  }
  .gcard__intro{ color:rgba(16,20,24,.8); }
  .tag{ background:rgba(16,20,24,.06); border-color:rgba(16,20,24,.12); color:#101418; }
}

@media (prefers-reduced-motion:reduce){
  .gcard, .gcard__overlay { transition:none !important; }
}

</style>
