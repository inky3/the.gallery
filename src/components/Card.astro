---
// Props
const { title, image, href = "#", intro = "", type = "" } = Astro.props;
---

<a class="gcard" href={href} aria-label={title}>
  <figure class="gcard__fig" data-fig>
    <img class="gcard__img" src={image} alt={title} loading="lazy" decoding="async" />

    <!-- Dark veil (only visible on hover / show-info) -->
    <div class="gcard__veil" aria-hidden="true"></div>

    <!-- IDLE: bottom-centered title pill -->
    <div class="gcard__idle">
      <span class="gcard__idlePill">{title}</span>
    </div>

    <!-- HOVER/MOBILE: full caption -->
    <figcaption class="gcard__cap">
      <strong class="gcard__capTitle">{title}</strong>
      {intro && <p class="gcard__capIntro">{intro}</p>}
      {type && <span class="gcard__chip">{type}</span>}
    </figcaption>
  </figure>
</a>

<style>
  .gcard{ display:block; text-decoration:none; color:inherit; }

  .gcard__fig{
    position:relative; overflow:hidden; border-radius:18px;
    aspect-ratio:16/10; background:#000; box-shadow:0 10px 26px rgba(16,20,24,.12);

    /* ============ THEME KNOBS (edit these) ============ */
    --veil-idle-opacity: 0;                 /* overlay at rest */
    --veil-hover-opacity: .85;              /* overlay on hover/show */
    --idle-pill-bg: rgba(20,22,24,.86);     /* pill bg (idle) */
    --idle-pill-color: #fff;                /* pill text color */
    --idle-pill-pad: .58rem 1.15rem;        /* pill padding (size) */
    --idle-pill-radius: 999px;              /* pill roundness */
    --cap-text: #fff;                       /* caption text color */
    --cap-shadow: 0 2px 4px rgba(0,0,0,.55);/* caption text shadow */
  }

  .gcard__img{
    width:100%; height:100%; object-fit:cover; display:block;
    transform:scale(1.02);
    transition:transform .35s ease, opacity .35s ease;
  }

  .gcard__veil{
    position:absolute; inset:0; border-radius:inherit;
    background:linear-gradient(to top,
      rgba(0,0,0,.65) 0%,
      rgba(0,0,0,.28) 45%,
      rgba(0,0,0,0) 100%);
    opacity:var(--veil-idle-opacity);
    transition:opacity .28s ease;
    pointer-events:none;
  }

  /* IDLE pill (always visible at rest) */
  .gcard__idle{
    position:absolute; left:0; right:0; bottom:18px;
    display:grid; place-items:center;
    transition:opacity .22s ease, transform .22s ease;
    opacity:1 !important;             /* keep visible */
    transform:translateY(0) !important;
  }
  .gcard__idlePill{
    max-width:calc(100% - 32px);
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    color:var(--idle-pill-color); background:var(--idle-pill-bg);
    padding:var(--idle-pill-pad); border-radius:var(--idle-pill-radius);
    font-weight:900; letter-spacing:.2px;
    text-shadow:0 1px 2px rgba(0,0,0,.35);
    box-shadow:0 4px 16px rgba(0,0,0,.18), inset 0 0 0 1px rgba(255,255,255,.06);
  }

  /* CAPTION (hidden at rest) */
  .gcard__cap{
    position:absolute; left:16px; right:16px; bottom:16px;
    display:grid; gap:.4rem;
    color:var(--cap-text);
    text-shadow:var(--cap-shadow);
    transform:translateY(12px);
    opacity:0 !important;             /* hidden idle */
    transition:transform .28s ease, opacity .28s ease;
  }
  .gcard__capTitle{ font-weight:900; }
  .gcard__capIntro{ margin:0; opacity:.95; line-height:1.28; }

  .gcard__chip{
    display:inline-block; padding:.38rem .8rem; font-weight:800; font-size:.8rem;
    border-radius:999px; color:#fff; backdrop-filter:blur(4px);
    background:rgba(255,255,255,.18);
    box-shadow:inset 0 0 0 1px rgba(255,255,255,.28);
  }

  /* Desktop hover reveal */
  .gcard__fig:hover .gcard__img{ transform:scale(1.06); }
  .gcard__fig:hover .gcard__veil{ opacity:var(--veil-hover-opacity) !important; }
  .gcard__fig:hover .gcard__cap{ transform:translateY(0); opacity:1 !important; }
  .gcard__fig:hover .gcard__idle{ opacity:0 !important; transform:translateY(6px) !important; }

  /* Mobile: .show-info toggled from page script */
  .gcard__fig.show-info .gcard__veil{ opacity:var(--veil-hover-opacity) !important; }
  .gcard__fig.show-info .gcard__cap{ transform:translateY(0); opacity:1 !important; }
  .gcard__fig.show-info .gcard__idle{ opacity:0 !important; transform:translateY(6px) !important; }
</style>
