---
import Main from "../layouts/Main.astro";
import Card from "../components/Card.astro";

const hero = {
  head: "The.Gallery",
  description: "Exploring our highlighted work"
};
---

<Main head={hero.head} description={hero.description}>
  <section class="py-5">
    <div class="container">
      <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">
        <h2 class="mb-3 mb-md-0">From Our Gallery</h2>

        <!-- Filter Nav -->
        <ul class="nav navline flex-wrap justify-content-center justify-content-md-start" id="filterNav">
          <li class="nav-item">
            <a class="nav-link active" data-filter="all" href="#">Highlight</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-filter="photography" href="#">Photography</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-filter="terrarium" href="#">Terrarium</a>
          </li>

          <!-- moving underline -->
          <div class="indicator d-none d-md-block"></div>
        </ul>
      </div>

      <!-- âœ… mobile-only â€œshow descriptionâ€ button -->
      <div class="mb-3 d-md-none">
        <button id="toggleDescriptions" class="btn btn-outline-dark btn-sm rounded-pill px-3">
          ðŸ‘€ Show descriptions
        </button>
      </div>

      <!-- Gallery Cards -->
      <div class="container overflow-hidden text-center">
        <div class="row g-4 position-relative" id="gallery">
          <Card
            title="Alone in the Grey"
            image="img/poster/alone-in-the-grey.png"
            category="poster"
            intro="à¸ à¸²à¸žà¹‚à¸›à¸ªà¹€à¸•à¸­à¸£à¹Œ Aline in the grey à¸—à¸µà¹ˆà¹à¸ªà¸”à¸‡à¹ƒà¸«à¹‰à¹€à¸«à¹‡à¸™à¸–à¸¶à¸‡à¸„à¸§à¸²à¸¡à¹€à¸«à¸‡à¸²à¹ƒà¸™à¸¢à¸²à¸¡à¹€à¸¢à¹‡à¸™"
            href="/the.gallery/gallery/poster/alone-in-the-grey"
          />
          <Card
            title="Casa Lapin Coffee Bean"
            image="img/photography/casa-lapin.jpg"
            category="photography"
            intro="Packaged à¹€à¸¡à¸¥à¹‡à¸”à¸à¸²à¹à¸Ÿ à¸„à¸²à¹€à¸Ÿà¹ˆ Casa Lapin à¹‚à¸—à¸™à¸­à¸¸à¹ˆà¸™ à¹à¸ªà¸‡à¸™à¸¸à¹ˆà¸¡"
          />
          <Card
            title="Duck"
            image="img/terrarium/Duck.jpg"
            category="terrarium"
            intro="à¸ªà¸§à¸™à¸‚à¸§à¸”à¹à¸à¹‰à¸§à¸¡à¸´à¸™à¸´ à¸žà¸£à¹‰à¸­à¸¡à¸•à¸¸à¹Šà¸à¸•à¸²à¹€à¸›à¹‡à¸”à¸™à¹‰à¸­à¸¢"
            href="/the.gallery/gallery/terrarium"
          />
          <Card
            title="Alley 7"
            image="/img/poster/Alley7.png"
            category="poster"
            intro="à¹‚à¸›à¸ªà¹€à¸•à¸­à¸£à¹Œ Alley 7 à¸—à¸µà¹ˆà¹à¸ªà¸”à¸‡à¸–à¸¶à¸‡à¸‹à¸­à¸¢à¹€à¸¥à¹‡à¸à¹† à¸“ Siam Square"
            href="/the.gallery/gallery/poster/alley7"
          />
          <Card
            title="Porsche 956"
            image="img/photography/porsche956/IMG_9504.JPG"
            category="photography"
            intro="à¸ à¸²à¸ž Collection à¸Šà¸¸à¸”à¸£à¸–à¹à¸‚à¹ˆà¸‡ Le Mans Porsche 956"
            href="/the.gallery/gallery/photography/porsche956"
          />
          <Card
            title="Le Mans"
            image="img/book/le-mans-book.jpg"
            category="book"
            intro="à¹à¸¡à¸à¸‹à¸µà¸™à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸›à¸à¹à¸‚à¹‡à¸‡à¸ˆà¸³à¸¥à¸­à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¹à¸‚à¹ˆà¸‡à¸£à¸– Endurance Racing"
          />
          <Card
            title="Creativity of Aerodynamic"
            image="img/book/creativity-of-aerodynamic.jpg"
            category="book"
            intro="à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸—à¸”à¸¥à¸­à¸‡à¸­à¸­à¸à¹à¸šà¸šà¹€à¸¥à¸¢à¹Œà¹€à¸­à¸²à¸•à¹Œà¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¸«à¸¥à¸±à¸à¸à¸²à¸£à¸­à¸²à¸à¸²à¸¨à¸žà¸¥à¸¨à¸²à¸ªà¸•à¸£à¹Œ"
          />
        </div>
      </div>
    </div>
  </section>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      /* ====== FILTER ====== */
      const filterNav = document.getElementById("filterNav");
      const cards = document.querySelectorAll(".gallery-card");

      if (filterNav && cards.length) {
        filterNav.addEventListener("click", (e) => {
          const el = e.target;
          if (!(el instanceof HTMLElement) || el.tagName !== "A") return;
          e.preventDefault();

          // set active
          filterNav.querySelectorAll("a").forEach((link) => link.classList.remove("active"));
          el.classList.add("active");

          const filter = (el.getAttribute("data-filter") || "all").toLowerCase();

          cards.forEach((card) => {
            const cat = (card.dataset.category || "").toLowerCase();
            const col = card.closest(".gallery-col");
            const match = filter === "all" || cat === filter;
            if (col) {
              col.style.display = match ? "" : "none";
            }
          });
        });
      }

      /* ====== MOVING INDICATOR ====== */
      const navLinks = document.querySelectorAll(".navline a");
      const indicator = document.querySelector(".indicator");
      if (indicator && navLinks.length) {
        const moveIndicator = (link) => {
          const linkRect = link.getBoundingClientRect();
          const parentRect = link.closest(".navline").getBoundingClientRect();
          indicator.style.width = linkRect.width + "px";
          indicator.style.left = linkRect.left - parentRect.left + "px";
        };
        const active = document.querySelector(".navline a.active");
        if (active) moveIndicator(active);

        navLinks.forEach((link) => {
          link.addEventListener("click", (e) => {
            navLinks.forEach((l) => l.classList.remove("active"));
            e.currentTarget.classList.add("active");
            moveIndicator(e.currentTarget);
          });
        });

        window.addEventListener("resize", () => {
          const current = document.querySelector(".navline a.active");
          if (current) moveIndicator(current);
        });
      }

      /* ====== MOBILE â€œSHOW DESCRIPTIONSâ€ TOGGLE ====== */
      const toggleBtn = document.getElementById("toggleDescriptions");
      if (toggleBtn) {
        toggleBtn.addEventListener("click", () => {
          document.body.classList.toggle("show-card-intro");
          const isOn = document.body.classList.contains("show-card-intro");
          toggleBtn.textContent = isOn ? "ðŸ™ˆ Hide descriptions" : "ðŸ‘€ Show descriptions";
        });
      }
    });
  </script>

  <style>
    .gallery-card { transition: transform 0.4s ease, opacity 0.4s ease; }

    .navline {
      display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem;
      position: relative; padding: 0.3rem 0; border-bottom: 2px solid #555; margin: 0;
    }
    @media (max-width: 767.98px) { .navline { justify-content: center; } }
    .navline a { text-decoration: none; font-size: 1rem; color: #888; position: relative; padding-bottom: .5rem; transition: color .3s; }
    .navline a.active { color: #000; font-weight: 600; }
    .indicator { position: absolute; bottom: -2px; height: 2px; background: #000; transition: all .3s; }
    .indicator::before {
      content: ""; position: absolute; top: -5px; left: 50%; transform: translateX(-50%);
      width: 0; height: 0; border-left: 6px solid transparent; border-right: 6px solid transparent; border-bottom: 6px solid #000;
    }

    /* hide the mobile toggle on desktop */
    @media (min-width: 768px) {
      #toggleDescriptions { display: none !important; }
    }
  </style>
</Main>
