---
import Main from "../layouts/Main.astro";
import Nav from "../components/Nav.astro";
import Footer from "../components/Footer.astro";
import GlassCard from "../components/GlassCard.astro";
import Band from "../components/Band.astro";

const projects = [
  {
    title: "Good Health",
    meta: "UX/UI • Health",
    image: "/img/project/goodhealth/index.jpg",
    href: "/projects/goodhealth",
    intro: "วิจัย + ออกแบบ UX/UI สำหรับผู้ใช้ควบคุมน้ำตาล ต้นแบบบน Figma (Desktop/Mobile)",
    tags: ["uxui"]
  },
  {
    title: "Mad Pizza",
    meta: "UX/UI • Restaurant",
    image: "/img/project/madpizza.jpg",
    href: "/projects/madpizza",
    intro: "Digital iPad menu โทนแดงส้ม มาพร้อม micro-interactions ต้นแบบใน Figma",
    tags: ["uxui","coding"]
  },
  {
    title: "GBPT3D",
    meta: "Web App • Services",
    image: "/img/project/GBTP3D.jpg",
    href: "/projects/gbpt3d",
    intro: "คอนเซ็ปต์เว็บบริการพิมพ์ 3D โทนฟ้า-ขาว เน้นความน่าเชื่อถือและอ่านง่าย ออกแบบใน Figma",
    tags: ["uxui"]
  },
  {
    title: "Tanawat Work",
    meta: "Portfolio • Mixed Media",
    image: "/img/project/tanawatwork.jpg",
    href: "/projects/tanawat-work",
    intro: "พอร์ตโฟลิโอสไตล์ Necron (Warhammer 40k) ออกแบบ UX/UI และพัฒนา Astro เองทั้งหมด",
    tags: ["uxui","coding"]
  },
  {
    title: "The Memories",
    meta: "Photography • Identity",
    image: "/img/project/thememories.jpg",
    href: "/projects/the-memories",
    intro: "พอร์ตโฟลิโอภาพถ่าย โทนส้ม-ฟิล์มวินเทจ เล่าแนวคิดความทรงจำ",
    tags: ["uxui"]
  },
];
---

<Main head="Projects — THE.GALLERY" description="Selected works in a glossy, glass-framed grid.">
  <Fragment slot="nav"><Nav /></Fragment>

  <!-- Compact dark band (fixed height + white copy) -->
 <Band
  title="Projects"
  lead="Explore my Website that I created myself."
  variant="dark"
  align="center"
  height={180}
  overlay={0.15}
/>

<section class="intro-text">
  <div class="container-narrow">
</section>

  <section class="section section-tight">
    <div class="container-narrow">
      <!-- Category slider -->
      <div class="filter-rail" role="tablist" aria-label="Filter projects">
        <button class="chip is-active" data-filter="all" role="tab" aria-selected="true">All</button>
        <button class="chip" data-filter="uxui" role="tab" aria-selected="false">UX/UI Design</button>
        <button class="chip" data-filter="coding" role="tab" aria-selected="false">Coding</button>
      </div>

      <div class="ggrid" id="projects-grid">
        {projects.map(p => (
          <GlassCard
            href={p.href}
            title={p.title}
            meta={p.meta}
            image={p.image}
            intro={p.intro}
            tags={p.tags}
            ratio="16/9"
          />
        ))}
      </div>
    </div>
  </section>

  <Fragment slot="footer"><Footer /></Fragment>

  <style>
    /* tighten spacing under the compact hero */
    .section-tight { padding-top: 1.25rem; }

    .filter-rail{
      display:flex; gap:.5rem; padding:.4rem; border-radius:999px;
      background:var(--bg-soft,#eef1f4); border:1px solid var(--border-subtle,rgba(0,0,0,.06));
      width:max-content; margin: 0 auto 1.1rem;
    }
    .chip{
      appearance:none; border:none; background:transparent; cursor:pointer;
      padding:.5rem 1rem; border-radius:999px; font-weight:700;
      color:var(--text-strong,#101418); opacity:.85; transition:background .18s, color .18s, transform .1s, opacity .18s;
    }
    .chip:hover{ transform:translateY(-1px); opacity:1; }
    .chip.is-active{ background: var(--accent,#0f6657); color:#fff; opacity:1; }

    .ggrid{
      --cols:3;
      display:grid; gap:1.1rem;
      grid-template-columns:repeat(var(--cols), minmax(0,1fr));
    }
    @media (max-width:1000px){ .ggrid{ --cols:2; } }
    @media (max-width:640px){ .ggrid{ --cols:1; } }
  </style>

  <!-- Behavior: filter + tap-to-open + desktop hover safety -->
  <script is:inline>
    (() => {
      const grid  = document.getElementById('projects-grid');
      const chips = Array.from(document.querySelectorAll('.filter-rail .chip'));
      const cards = Array.from(grid.querySelectorAll('.gcard'));

      const apply = (key) => {
        cards.forEach(c => {
          const tags = (c.dataset.tags || "").split(',').filter(Boolean);
          const hit = key === 'all' || tags.includes(key);
          c.style.display = hit ? '' : 'none';
        });
      };

      chips.forEach(btn => {
        btn.addEventListener('click', () => {
          chips.forEach(b => {
            const active = b === btn;
            b.classList.toggle('is-active', active);
            b.setAttribute('aria-selected', active ? 'true' : 'false');
          });
          apply(btn.dataset.filter);
        });
      });

      // Touch-friendly: tap to open glass panel, second tap navigates
      grid.addEventListener('click', (e) => {
        const a = e.target.closest('.gcard');
        if (!a) return;
        if (!a.classList.contains('is-open')) {
          e.preventDefault();
          Array.from(grid.querySelectorAll('.gcard.is-open')).forEach(x => x.classList.remove('is-open'));
          a.classList.add('is-open');
          setTimeout(() => a.classList.remove('is-open'), 4000);
        }
      });

      // Desktop hover safety
      cards.forEach(a => {
        a.addEventListener('pointerenter', () => a.classList.add('is-open'));
        a.addEventListener('pointerleave', () => a.classList.remove('is-open'));
      });
    })();
  </script>
</Main>
